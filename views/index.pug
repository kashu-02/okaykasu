doctype html
html(lang="ja")
  head
    meta(charset="UTF-8")
    title おk粕　Web版
    meta(charset="utf-8")
    meta(name="viewport" content="width=device-width, initial-scale=1")
    link(rel="stylesheet",
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css",
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk",
    crossorigin="anonymous")
  body
    nav(class="navbar navbar-dark bg-dark")
      a(href="#" class="navbar-brand") おk粕Web版
    div(class="container")
      div(class="card-header")
        h5(class="card-title") チャンク　#{chunkrange.date}
        h6(class="card-text") #{chunkrange.chunkrange}
      table
        tr
          th ネクステ
        tr
          td #{nextstagerange.date}
          td #{nextstagerange.nextstagerange}

    div(class="container")
      unless okaykasudata
        p 課題、連絡事項を表示するには学校のGoogleアカウントでのログインが必要です。
        a(href="/auth/google" class="btn btn-primary") ログイン
      else
          - var escapeMap = {'&':'&amp;', '\'':'&#39;', '"':'&quot;', '<':'&lt;', '>':'&gt;'};
          each okaykasudatum in okaykasudata
            div(class="container")
            if okaykasudatum.type === 'image'
              img(src=okaykasudatum.linemessage width="50%" height="50%")
            else if okaykasudatum.type === 'text'
              p !{okaykasudatum.linemessage.replace(/[&"'<>]/g,function(c){return escapeMap.hasOwnProperty(c)?escapeMap[c]:c}).replace(/\r?\n|\r/g,"<br>")}

  script(src="https://code.jquery.com/jquery-3.5.1.slim.min.js",
  integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj",
  crossorigin="anonymous")
  script(src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js",
  integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo",
  crossorigin="anonymous")
  script(src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js",
  integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI",
  crossorigin="anonymous")